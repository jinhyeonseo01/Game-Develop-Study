# 계층화 아키텍쳐

**계층화 아키텍쳐(Layered Architecture)**는 소프트웨어 설계에서 가장 일반적으로 사용되는 아키텍쳐입니다. 아키텍쳐를 구성하는 계층의 숫자에 따라 **N계층 아키텍쳐(N-tier Architecture)**라고도 합니다.

각 계층은 어플리케이션 내에서의 특정 역할과 관심사(화면 표시, 로직 수행, DB 작업 등) 별로 구분됩니다. 이는 계층화 아키텍쳐의 강력한 기능인 **‘관심사의 분리’**를 의미하며 특정 계층의 구성요소는 해당 계층에 관한 기능만을 수행하게됩니다.

그리고 이러한 특징을 통해 높은 유지보수성과 쉬운 테스트라는 장점을 얻을 수 있습니다.

## 4계층 아티텍쳐

계층화 아키텍쳐에서 일반적으로 각 구성 계층이 명시되어있지 않다면, 아래와 같은 4개의 레이어로 구분합니다.

<aside>
💡 꼭, 그런 것은 아니며 단순한 어플리케이션은 3계층, 더 복잡하면 5계층이 될 수도 있다.

</aside>

![Untitled](%E1%84%80%E1%85%A8%E1%84%8E%E1%85%B3%E1%86%BC%E1%84%92%E1%85%AA%20%E1%84%8B%E1%85%A1%E1%84%8F%E1%85%B5%E1%84%90%E1%85%A6%E1%86%A8%E1%84%8E%E1%85%A7%20d6768fa185144c75bec9fb38b104a76d/Untitled.png)

### Presentation Layer (표현 계층)

유저가 데이터를 전달하기 위해 화면에 정보를 표시하는 것이 주 관심사인 계층이다. 비지니스 로직이 어떻게 동작하는지는 알 필요가 없으며, 대표적인 구성 요소는 **View**와 **Controller**가 있다.

### Business Layer (비지니스 계층)

비지니스 로직을 수행하는 것이 주 관심사인 계층이다. 마찬가지로 화면에 데이터를 출력하는 방법이나 데이터를 어떻게 가져오는지는 알지 못하며, 그저 데이터를 받아와 비지니스 로직을 수행하고 그 결과를 전달하면 된다. 대표적인 구성 요소로는 **Service**와 **Domain Model** 등이 있다.

경우에 따라 Service와 Domain Model을 별개의 계층으로 나누거나 아예 Domain Model을 별개의 계층으로 나누는 경우도 있다.

### Persistence Layer (영속 계층)

어플리케이션의 영속성을 구현하기 위해, 데이터 출처와 그 데이터를 가져오고 다루는 것이 주 관심사인 계층이다. 대표적인 구성요소로는 **Repository**, **DAO**등이 있다.

### Database Layer (데이터 베이스 계층)

MySQL, MariaDB, PostgreSQL, MongoDB 등 데이터베이스가 위치한 계층을 의미한다.

### 수직적으로 격리된 레이어

계층화 아키텍쳐에서 각각의 나뉘어진 수평 계층은 수직적으로 배치된다. 레이어는 바로 하위 레이어에만 연결된다.

> 그냥 Presentation Layer 에서 그냥 Database Layer 에 연결해서 정보를 가져오는게 더 편하지 않을까?
> 

Presenstation Layer 에서 직접 데이터베이스에 접속하여 데이터를 가져오게 되면, SQL에 대한 변경사항이 Presentation Layer에 직접 영향을 미친다. 즉, 과도한 의존성이 발생하게 된다. 이는 어플리케이션의 변경을 매우 어렵게 만든다.

## 계층화 아키텍쳐 ****시나리오****

사용자가 특정 고객 정보를 요청한 상황을 가정하여, 계층화 아키텍쳐가 이 요청을 수행하는 시나리오를 정리해보자.

1. 사용자가 보고있는 화면(흔히 말하는 **View**라고 할 수 있을 것 같다)에서 사용자는 고객 정보를 요청한다.
2. 이 요청은 그 요청을 처리할 수 있는 모듈이 무엇인지 알고있는 Customer Delegate (흔히 말하는 **Controller**라고 할 수 있을 것 같다) 로 전달된다. Customer Delegate 는 해당 요청을 처리하기 위해 **Business Layer**의 Customer Object로 요청을 다시 전달한다.
3. Customer Object는 요청을 받고 비즈니스 로직을 수행하기 위한 데이터를 얻기 위해, **Persistence Layer**의 Customer **DAO**와 Order **DAO**에 요청을 보낸다.
4. Persistence Layer의 DAO들은 요청을 수행하기 위해 **Database Layer**에 접근하여 데이터를 가져온다.
5. 이 요청은 다시 반대로 **Persistence Layer** → **Business Layer** → **Presentation Layer**로 전달되고 최종적으로 사용자에게 전달된다.